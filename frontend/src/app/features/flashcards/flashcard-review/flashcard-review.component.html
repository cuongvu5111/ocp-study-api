<div class="flashcard-review">
    <header class="review-header">
        <a routerLink="/flashcards" class="btn btn--ghost btn--icon">
            <span class="material-icons-outlined">arrow_back</span>
        </a>
        <h1>Review Flashcards</h1>
        <div class="progress-info">
            {{ currentIndex() + 1 }} / {{ cards().length }}
        </div>
    </header>

    <div class="progress mb-6">
        <div class="progress__bar"
            [style.width.%]="cards().length > 0 ? ((currentIndex() + 1) / cards().length) * 100 : 0"></div>
    </div>

    @if (loading()) {
    <div class="loading-state">
        <div class="spinner"></div>
        <p>ƒêang t·∫£i flashcards...</p>
    </div>
    } @else if (cards().length === 0) {
    <div class="empty-state">
        <span class="material-icons-outlined">style</span>
        <p>Ch∆∞a c√≥ flashcard n√†o ƒë·ªÉ review</p>
        <a routerLink="/flashcards" class="btn btn--primary">
            <span class="material-icons-outlined">add</span>
            T·∫°o flashcard
        </a>
    </div>
    } @else if (reviewComplete()) {
    <div class="complete-state">
        <span class="completion-icon">üéâ</span>
        <h2>Ho√†n th√†nh!</h2>
        <p>B·∫°n ƒë√£ review t·∫•t c·∫£ {{ cards().length }} flashcards</p>
        <div class="stats-summary">
            <div class="stat correct">
                <span class="stat-value">{{ correctCount() }}</span>
                <span class="stat-label">ƒê√£ thu·ªôc</span>
            </div>
            <div class="stat incorrect">
                <span class="stat-value">{{ incorrectCount() }}</span>
                <span class="stat-label">Ch∆∞a thu·ªôc</span>
            </div>
            <div class="stat accuracy">
                <span class="stat-value">{{ Math.round((correctCount() / cards().length) * 100) }}%</span>
                <span class="stat-label">Accuracy</span>
            </div>
        </div>
        <div class="complete-actions">
            <button class="btn btn--secondary" (click)="restartReview()">
                <span class="material-icons-outlined">refresh</span>
                Review l·∫°i
            </button>
            <a routerLink="/flashcards" class="btn btn--primary">
                <span class="material-icons-outlined">arrow_back</span>
                Quay l·∫°i
            </a>
        </div>
    </div>
    } @else {
    <div class="flashcard" [class.flipped]="isFlipped()" (click)="flip()">
        <div class="flashcard__inner">
            <div class="flashcard__front">
                <span class="card-label">
                    <span class="material-icons-outlined">help_outline</span>
                    C√¢u h·ªèi
                </span>
                <p class="card-content">{{ currentCard()!.front }}</p>
                <span class="card-topic">{{ currentCard()!.topicName }}</span>
                <span class="hint">
                    <span class="material-icons-outlined">touch_app</span>
                    Click ƒë·ªÉ xem ƒë√°p √°n
                </span>
            </div>
            <div class="flashcard__back">
                <span class="card-label">
                    <span class="material-icons-outlined">lightbulb</span>
                    ƒê√°p √°n
                </span>
                <p class="card-content">{{ currentCard()!.back }}</p>
                @if (currentCard()!.codeExample) {
                <pre class="code-example"><code>{{ currentCard()!.codeExample }}</code></pre>
                }
            </div>
        </div>
    </div>

    @if (isFlipped()) {
    <div class="review-actions">
        <button class="btn btn--error" (click)="markReview(false)">
            <span class="material-icons-outlined">close</span>
            Ch∆∞a thu·ªôc
        </button>
        <button class="btn btn--success" (click)="markReview(true)">
            <span class="material-icons-outlined">check</span>
            ƒê√£ thu·ªôc
        </button>
    </div>
    }
    }
</div>